<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GT7 Sez√≥na 2025</title>
  <link rel="stylesheet" href="GT7style.css" />
  <script>
    // make showTab available early for inline handlers
    window.showTab = function(tab){
      document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c=>c.classList.add('hidden'));
      const btns = document.querySelectorAll('.tab-btn');
      btns.forEach(b=>{ if(b.dataset.tab === tab) b.classList.add('active'); });
      const el = document.getElementById(tab);
      if(el) el.classList.remove('hidden');
    };
  </script>
</head>
<body>
  <div class="container">
    <header class="site-header">
      <div>
        <h1>üèÅ GT7 Racing Championship 2025</h1>
        <div class="small">P≈ôehled z√°vod≈Ø, v√Ωsledk≈Ø a statistik</div>
      </div>
      <div class="auth-controls">
        <button id="btn-signin" class="btn">P≈ôihl√°sit se (Google)</button>
        <button id="btn-signout" class="btn secondary hidden">Odhl√°sit se</button>
        <div id="user-email" class="small"></div>
      </div>
    </header>

    <nav class="tabs">
      <button class="tab tab-btn active" data-tab="current" onclick="showTab('current')">Aktu√°ln√≠ sez√≥na</button>
      <button class="tab tab-btn" data-tab="archive" onclick="showTab('archive')">Archiv</button>
      <button class="tab tab-btn" data-tab="hall" onclick="showTab('hall')">Hall of Fame</button>
      <button class="tab tab-btn" data-tab="h2h" onclick="showTab('h2h')">Porovn√°n√≠ (H2H)</button>
      <button class="tab tab-btn" data-tab="profile" onclick="showTab('profile')">M≈Øj profil</button>
      <button class="tab tab-btn" data-tab="admin" onclick="showTab('admin')">Admin</button>
    </nav>

    <main>
      <!-- CURRENT -->
      <section id="current" class="tab-content">
        <div id="upcoming-container"></div>

        <div class="section">
          <h2>Pr≈Øbƒõ≈æn√© po≈ôad√≠</h2>
          <div class="leaderboard-controls">
            <input id="search-driver" placeholder="üîç Hledat jezdce">
            <label>Min. starty <input id="min-starts" type="number" value="0" min="0"></label>
            <label>Sez√≥na <select id="season-select"></select></label>
          </div>
          <div id="leaderboard-container"></div>
          <canvas id="points-chart" class="chart"></canvas>
        </div>

        <div class="section">
          <h2>Statistiky</h2>
          <div id="stats-container"></div>
        </div>

        <div class="section">
          <h2>V√Ωsledky z√°vod≈Ø</h2>
          <div id="past-races"></div>
        </div>
      </section>

      <!-- ARCHIVE -->
      <section id="archive" class="tab-content hidden">
        <div class="section">
          <h2>Archiv sez√≥n</h2>
          <div id="archive-content"></div>
        </div>
      </section>

      <!-- HALL -->
      <section id="hall" class="tab-content hidden">
        <div class="section">
          <h2>Hall of Fame</h2>
          <div id="hall-of-fame"></div>
          <canvas id="hall-bar-chart" class="chart"></canvas>
        </div>
        <div class="section">
          <h2>Fun facts</h2>
          <div id="fun-facts"></div>
        </div>
      </section>

      <!-- H2H -->
      <section id="h2h" class="tab-content hidden">
        <div class="section">
          <h2>Head-to-Head porovn√°n√≠</h2>
          <div class="h2h-controls">
            <input id="h2h-a" placeholder="Jezdec A (nick)">
            <input id="h2h-b" placeholder="Jezdec B (nick)">
            <label>Sez√≥na <select id="h2h-season"><option value="all">All-time</option></select></label>
            <button id="h2h-run" class="btn">Porovnat</button>
          </div>
          <div id="h2h-result"></div>
        </div>
      </section>

      <!-- PROFILE -->
      <section id="profile" class="tab-content hidden">
        <div class="section">
          <h2>M≈Øj profil</h2>
          <div id="profile-view" class="profile-view">
            <img id="profile-avatar" alt="avatar" class="avatar-placeholder">
            <div id="profile-name" class="profile-name"></div>
            <div id="profile-email" class="small"></div>
            <div id="profile-bio" class="small"></div>
          </div>

          <form id="profile-form" class="profile-form">
            <label>Nick: <input id="profile-nick"></label>
            <label>T√Ωm: <input id="profile-team"></label>
            <label>Bio: <textarea id="profile-bio-input" rows="3"></textarea></label>
            <label>Obl√≠ben√° auta (ƒç√°rkou): <input id="profile-preferred"></label>
            <label>Avatar: <input id="profile-avatar-file" type="file" accept="image/*"></label>
            <div style="margin-top:8px">
              <button type="submit" class="btn">Ulo≈æit profil</button>
            </div>
          </form>
        </div>
      </section>

      <!-- ADMIN -->
      <section id="admin" class="tab-content hidden">
        <div class="section">
          <h2>Admin: P≈ôidat / upravit z√°vod</h2>
          <div id="not-admin" class="small">P≈ôihlaste se jako admin (Google) pro √∫pravy.</div>
          <div id="admin-forms" class="hidden">
            <form id="race-form" class="admin-form">
              <input type="hidden" id="edit-id" />
              <div class="form-row">
                <label>Datum: <input type="datetime-local" id="race-date" required></label>
                <label>Okruh: <input id="circuit-name" required></label>
              </div>
              <div class="form-row">
                <label>Povolen√° auta: <input id="allowed-cars"></label>
                <label>PP limit: <input type="number" id="pp-limit"></label>
              </div>
              <hr>
              <h4>Parametry z√°vodu</h4>
              <div class="form-row">
                <label>BoP: <select id="bop-enabled"><option value="false">Ne</option><option value="true">Ano</option></select></label>
                <label>Tuning: <select id="tuning-allowed"><option value="false">Zak√°z√°n</option><option value="true">Povolen</option></select></label>
              </div>
              <div class="form-row">
                <label>Kategorie pneumatik: <select id="tire-category"><option>Komfortn√≠</option><option>Sportovn√≠</option><option>Z√°vodn√≠</option></select></label>
                <label>Povinn√° smƒõs: <select id="mandatory-compound"><option>Bez povinn√©</option><option>Mƒõkk√°</option><option>St≈ôedn√≠</option><option>Tvrd√°</option></select></label>
              </div>
              <div class="form-row">
                <label>Poƒçet kol: <input type="number" id="laps" value="10"></label>
                <label>Spot≈ôeba (x): <input type="number" id="fuel-consumption" value="1"></label>
              </div>
              <div class="form-row">
                <label>Opot≈ôeben√≠ (x): <input type="number" id="tire-wear" value="1"></label>
                <label>Tankov√°n√≠ (l/s): <input type="number" id="refuel-speed" value="5"></label>
              </div>
              <label>YouTube URL: <input type="url" id="youtube-url"></label>
              <div style="margin-top:10px">
                <button class="btn" type="submit">Ulo≈æit z√°vod</button>
                <button type="button" class="btn secondary" onclick="resetRaceForm()">Reset</button>
              </div>
            </form>

            <hr>
            <h3>Seznam z√°vod≈Ø (admin)</h3>
            <div id="admin-race-list"></div>

            <hr>
            <h3>Zadat v√Ωsledky (1.‚Äì5., DNS)</h3>
            <form id="results-form" class="admin-form">
              <label>Vyber z√°vod: <select id="select-race"></select></label>
              <div id="positions-container" class="grid-results"></div>
              <label>YouTube v√Ωsledk≈Ø: <input type="url" id="youtube-url-results"></label>
              <div style="margin-top:8px">
                <button class="btn" type="submit">Ulo≈æit v√Ωsledky</button>
                <button type="button" class="btn secondary" onclick="resetResultsForm()">Reset</button>
              </div>
            </form>
          </div>
        </div>
      </section>
    </main>

    <footer class="small" style="text-align:center;margin:18px 0">GT7 Community ‚Ä¢ verze fix9</footer>
  </div>

  <!-- Chart.js UMD -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- App script (module) -->
  <script type="module" src="./GT7script.js"></script>
</body>
</html>
