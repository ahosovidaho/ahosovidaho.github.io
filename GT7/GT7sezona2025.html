<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GT7 Racing Championship 2025</title>
  <link rel="stylesheet" href="GT7style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    // Robust global showTab - works even if called without event (Safari, mobile) and when main script is module-scoped.
    window.showTab = function(tab, evt) {
      // remove active class from all tabs
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));

      // try to set active on the clicked element; if event missing, find a matching button
      if (evt && evt.target) {
        evt.target.classList.add('active');
      } else {
        // fallback: find a .tab button whose onclick mentions the tab name
        const btn = Array.from(document.querySelectorAll('.tab')).find(b => {
          const oc = b.getAttribute('onclick') || '';
          return oc.indexOf("'" + tab + "'") >= 0 || oc.indexOf('"' + tab + '"') >= 0 || oc.indexOf(tab) >= 0;
        });
        if (btn) btn.classList.add('active');
      }

      // hide all tab panels (elements with id ending in -tab)
      document.querySelectorAll('[id$="-tab"]').forEach(el => el.classList.add('hidden'));

      // show requested tab panel
      const panel = document.getElementById(tab + '-tab');
      if (panel) panel.classList.remove('hidden');
    };
  </script>

</head>
<body>
  <div class="container">
    <header>
      <h1>üèÅ GT7 Racing Championship 2025</h1>
      <div class="small">Ofici√°ln√≠ p≈ôehled z√°vod≈Ø, v√Ωsledk≈Ø a statistik</div>
    </header>

    <div class="tabs">
      <button class="tab active" onclick="showTab('current', event)">Aktu√°ln√≠ sez√≥na</button>
      <button class="tab" onclick="showTab('archive', event)">Archiv</button>
      <button class="tab" onclick="showTab('hall', event)">Hall of Fame</button>
      <button class="tab" onclick="showTab('admin', event)">Admin</button>
    </div>

    <div id="current-tab">
      <div class="section">
        <h2>Pr≈Øbƒõ≈æn√© po≈ôad√≠</h2>
        <div class="leaderboard-controls">
          <input type="text" id="search-driver" placeholder="üîç Hledat jezdce">
          <label>Min. starty: <input type="number" id="min-starts" value="0" min="0"></label>
        </div>
        <div id="leaderboard-container"></div>
        <canvas id="points-chart" style="margin-top:20px; max-height:400px;"></canvas>
      </div>

      <div class="section">
        <h2>Statistiky</h2>
        <div id="stats-container"></div>
      </div>

      <div class="section">
        <h2>V√Ωsledky z√°vod≈Ø</h2>
        <div id="past-races"></div>
      </div>
    </div>

    <div id="archive-tab" class="hidden">
      <div class="section">
        <h2>Archiv sez√≥n</h2>
        <div id="archive-content"></div>
      </div>
    </div>

    <div id="hall-tab" class="hidden">
      <div class="section">
        <h2>Hall of Fame üèÜ</h2>
        <div id="hall-of-fame"></div>
      </div>
      <div class="section">
        <h2>Fun facts ü§ì</h2>
        <div id="fun-facts"></div>
      </div>
    </div>

    <div id="admin-tab" class="hidden">
      <div id="admin-panel"></div>
    </div>
  </div>

  <div id="driver-modal" class="modal hidden">
    <div class="modal-content">
      <button class="close-btn" onclick="closeDriverModal()">‚úï</button>
      <h2 id="driver-name"></h2>
      <div id="driver-summary"></div>
      <canvas id="driver-points-chart" style="max-height:300px;margin:15px 0;"></canvas>
      <div id="driver-race-history"></div>
    </div>
  </div>

  <script src="GT7script.js" type="module"></script>
</body>
</html>